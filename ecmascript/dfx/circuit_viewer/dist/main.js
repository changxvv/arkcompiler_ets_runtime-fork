(()=>{var t={910:(t,e,i)=>{const{GLFrame:s}=i(413),{Scr:o}=i(245),{XTools:l}=i(631),{XSelect:r}=i(380),{X2DFast:h}=i(319),{IrViewer:n}=i(534),{LogParser:a}=i(108);class c{constructor(){l.LoadConfig(),this.filePoint_="",this.files_=[],this.viewer_={},a.Load("test.txt",this.onLoad.bind(this)),this.selectFile_=new r(this.files_,this.filePoint_),this.selectFile_.registCallback(this.changeFile.bind(this)),s.gi().pCallbackDropfile=this.onDrop.bind(this)}changeFile(t){this.filePoint_=t}onLoad(t,e){try{let i=new n(t,e);this.files_.indexOf(t)<0&&(this.files_.push(t),this.selectFile_.resetList(this.files_,t),this.changeFile(t)),this.viewer_[t]=i}catch(e){return l.PROC_TO=0,console.log(e),void alert("读取"+t+"失败")}}onDrop(t,e,i){if(1==t.length){let e=new FileReader;e.readAsDataURL(t[0]),e.onload=e=>{let i=atob(e.target.result.split(",")[1]);this.onLoad(t[0].name,i)}}}static pInstance_=null;static gi(){return null==c.pInstance_&&(c.pInstance_=new c),c.pInstance_}onDraw(){if(this.selectFile_.list_.length<=0)h.gi().drawText("拖入log文件",30,o.logicw/2,o.logich/2,1,1,0,-2,-2,4278190080);else{for(let t in this.viewer_)this.filePoint_==t&&this.viewer_[t].onDraw();this.selectFile_.move(o.logicw-200-10,10,200,20),this.selectFile_.draw(),l.PROC_TO>0&&l.PROC_TO<100&&h.gi().fillRect(0,o.logich-5,l.PROC_TO*o.logicw/100,5,4294901760)}}onTouch(t,e,i){if(this.selectFile_.list_.length<=0)return!0;if(this.selectFile_.onTouch(t,e,i))return!0;for(let s in this.viewer_)if(this.filePoint_==s&&this.viewer_[s].onTouch(t,e,i))return!0;return!1}onKey(t){for(let e in this.viewer_)if(this.filePoint_==e&&this.viewer_[e].onKey(t))return!0;return!0}}t.exports={MainEditor:c}},413:(t,e,i)=>{"use strict";i.r(e),i.d(e,{gl:()=>s,GLFrame:()=>m});var s,o=i(37),l=i(319),r=i(245),h=i(631);function n(t){document.addEventListener("contextmenu",(function(t){t.preventDefault()})),t.preventDefault(),m.pinstance_.callbackProctouch(1,t.touches[0].clientX,t.touches[0].clientY)}function a(t){t.preventDefault(),m.pinstance_.callbackProctouch(2,t.touches[0].clientX,t.touches[0].clientY)}function c(t){t.preventDefault(),m.pinstance_.callbackProctouch(3,t.changedTouches[0].clientX,t.changedTouches[0].clientY)}function d(t){switch(t.preventDefault(),t.button){case 0:m.pinstance_.callbackProctouch(1,t.offsetX,t.offsetY);break;case 2:m.pinstance_.callbackProctouch(4,t.offsetX,t.offsetY)}}function u(t){t.preventDefault(),m.pinstance_.callbackProctouch(2,t.offsetX,t.offsetY)}function p(t){switch(t.preventDefault(),t.button){case 0:m.pinstance_.callbackProctouch(3,t.offsetX,t.offsetY);break;case 2:m.pinstance_.callbackProctouch(6,t.offsetX,t.offsetY)}}function f(t){t.preventDefault(),t.wheelDeltaY>0?m.pinstance_.callbackProctouch(10,t.clientX,t.clientY):m.pinstance_.callbackProctouch(11,t.clientX,t.clientY)}function _(t){t.ctrlKey||(h.XTools.KEY_CTRL=!1),t.shiftKey||(h.XTools.KEY_SHIFT=!1),t.altKey||(h.XTools.KEY_ALT=!1),t.preventDefault()}function g(t){let e="";t.ctrlKey&&(e.length>0&&(e+="+"),e+="ctrl",h.XTools.KEY_CTRL=!0),t.shiftKey&&(e.length>0&&(e+="+"),e+="shift",h.XTools.KEY_SHIFT=!0),t.altKey&&(e.length>0&&(e+="+"),e+="alt",h.XTools.KEY_ALT=!0),e.length>0&&(e+="+"),e+=t.key,m.pinstance_.callbackKey(1,e),o.CanvasInput.FOCUS,"ctrl+z"!=e&&"ctrl+f"!=e&&"Enter"!=e||t.preventDefault()}function x(){m.pinstance_.callbackDraw(),window.requestAnimationFrame(x)}class m{static gi(){return m.pinstance_}constructor(){}go(t,e=null,i=null,o=null,l=null){s=t.getContext("webgl",{premultipliedAlpha:!1}),this.pCallbackDraw=e,this.pCallbackTouch=i,this.pCallbackKey=o,this.pCallbackLogic=l,this.pCallbackDropfile=null,t.addEventListener("touchstart",n),t.addEventListener("touchmove",a),t.addEventListener("touchend",c),t.addEventListener("mousedown",d),t.addEventListener("mousemove",u),t.addEventListener("mouseup",p),t.addEventListener("mousewheel",f),t.addEventListener("drop",(t=>{t.preventDefault(),m.gi().callbackDropfile(t.dataTransfer.files,t.offsetX,t.offsetY)})),t.addEventListener("dragover",(t=>{t.preventDefault()})),t.addEventListener("dragenter",(t=>{t.preventDefault()})),t.focus(),document.addEventListener("contextmenu",(function(t){t.preventDefault()})),window.addEventListener("keydown",g),window.addEventListener("keyup",_),window.requestAnimationFrame(x)}callbackKey(t,e){null!=this.pCallbackKey&&this.pCallbackKey(t,e)}callbackDraw(){s.clearColor(1,1,1,1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),null!=this.pCallbackDraw&&this.pCallbackDraw()}callbackProctouch(t,e,i){h.XTools.MOUSE_POS.x=e,h.XTools.MOUSE_POS.y=i,null!=this.pCallbackTouch&&(e=e*r.Scr.logicw/r.Scr.width,i=i*r.Scr.logich/r.Scr.height,this.pCallbackTouch(t,e,i))}callbackDropfile(t,e,i){null!=this.pCallbackDropfile&&this.pCallbackDropfile(t,e,i)}resize(){s.viewport(0,0,r.Scr.logicw,r.Scr.logich),l.X2DFast.gi().resetMat()}}m.pinstance_=new m},245:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Scr:()=>o});const{NapiLog:s}=i(324);class o{constructor(){}static ReSize(t,e){o.width=t,o.height=e,"width"==o.keeplogicworh?o.logich=o.logicw*e/t:o.logicw=o.logich*t/e}static setLogicScreenSize(t,e){if((o.logicw!=t||o.width!=t||o.logich!=e||o.height!=e)&&(o.logicw=t,o.logich=e,o.width=t,o.height=e,"undefined"!=typeof wx)){var i=wx.getSystemInfoSync();o.width=i.windowWidth,o.height=i.windowHeight}}}o.width=320,o.height=240,o.keeplogicworh="height",o.logicw=320,o.logich=240,o.fps=60},631:(t,e,i)=>{"use strict";i.r(e),i.d(e,{XTools:()=>s,fAngle:()=>o,iDistance:()=>l,timeMs:()=>r,freshTime:()=>h,TimeMS:()=>n,RandInt:()=>a,GetURL:()=>c});class s{constructor(){}static MOUSE_POS={x:0,y:0};static InRect(t,e,i,s,o,l){return!(t<i||e<s||t>i+o||e>s+l)}static PROC_TO=0;static CONFIG=null;static LoadConfig(){const t=new XMLHttpRequest;t.open("GET","config.json"),t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE)if(200===t.status)try{s.CONFIG=JSON.parse(t.responseText);for(let t in s.CONFIG.NodeColor)s.CONFIG.NodeColor[t]=parseInt(s.CONFIG.NodeColor[t],16);for(let t in s.CONFIG.LineColor)s.CONFIG.LineColor[t]=parseInt(s.CONFIG.LineColor[t],16)}catch(t){alert("Config file error")}else alert("Failed to load config file")},t.send()}}function o(t,e){return 180*Math.atan2(-e,t)/Math.PI}function l(t,e){return Math.sqrt(t*t+e*e)}var r=0;function h(){let t=new Date;r=t.getTime()}function n(){return(new Date).getTime()}function a(t=0,e=100){return Math.floor(Math.random()*(e-t))+t}function c(){return"undefined"!=typeof wx?"https://7465-testegg-19e3c9-1301193145.tcb.qcloud.la/":""}h()},905:(t,e,i)=>{const{X2DFast:s}=i(319);t.exports={XButton:class{constructor(t,e,i,o,l){this.pm2f_=s.gi(),this.move(t,e,i,o),this.name_=l,this.touchDown_=!1,this.clicked_=!1,this.rightClicked_=!1,this.disable_=!1,this.nameColor_=4294967295,this.backgroundColor_=4282941112}move(t,e,i,s){return this.posX_=t,this.posY_=e,this.posW_=i,this.posH_=s,this}draw(){let t=0;this.touchDown_&&(t=2105376),this.pm2f_.fillRect(this.posX_,this.posY_,this.posW_,this.posH_,this.backgroundColor_-t),null!=this.name_&&this.name_.length>0&&this.pm2f_.drawText(this.name_,14,this.posX_+this.posW_/2,this.posY_+this.posH_/2+2,1,1,0,-2,-2,this.nameColor_-t)}isTouchIn(t,e){return!(t<this.posX_||e<this.posY_||t>this.posX_+this.posW_||e>this.posY_+this.posH_)}onTouch(t,e,i){let s=this.isTouchIn(e,i);switch(t){case 1:s&&(this.touchDown_=!0);break;case 2:break;case 3:this.touchDown_&&s&&(this.onClicked_?this.onClicked_():this.clicked_=!0),this.touchDown_=!1;break;case 4:s&&(this.rightDown_=!0);break;case 6:this.rightDown_&&s&&(this.rightClicked_=!0),this.rightDown_=!1}return s}isClicked(){return!!this.clicked_&&(this.clicked_=!1,!0)}isRightClicked(){return!!this.rightClicked_&&(this.rightClicked_=!1,!0)}}}},215:(t,e,i)=>{const{X2DFast:s}=i(319);t.exports={XScroll:class{constructor(t){t.type?this.type_=t.type:this.type_="right",this.barOff_=0,this.useScrH_=!1}move(t,e,i,s){return this.posX_=t,this.posY_=e,this.posW_=i,this.posH_=s,this}draw(){s.gi().fillRect(this.posX_,this.posY_,this.posW_,this.posH_,1082163328),"right"==this.type_?s.gi().fillRect(this.posX_+1,this.posY_+this.barOff_,this.posW_-2,this.posH_/3,1073741824):"button"==this.type_&&s.gi().fillRect(this.posX_+this.barOff_,this.posY_+1,this.posW_/3,this.posH_-2,1073741824)}isTouchIn(t,e){return!(t<this.posX_||e<this.posY_||t>this.posX_+this.posW_||e>this.posY_+this.posH_)}setBarOff(t){"right"==this.type_?this.barOff_=2*this.posH_/3*t:this.barOff_=2*this.posW_/3*t,this.modifyBarOff(0,0)}getBarOff(){return"right"==this.type_?this.barOff_/(2*this.posH_/3):this.barOff_/(2*this.posW_/3)}modifyBarOff(t,e){"right"==this.type_?(this.barOff_+=e,this.barOff_>2*this.posH_/3&&(this.barOff_=2*this.posH_/3)):(this.barOff_+=t,this.barOff_>2*this.posW_/3&&(this.barOff_=2*this.posW_/3)),this.barOff_<0&&(this.barOff_=0)}onTouch(t,e,i){let s=this.isTouchIn(e,i);switch(t){case 10:"right"==this.type_?this.modifyBarOff(0,-this.posH_/3/10):s&&this.modifyBarOff(-this.posW_/3/10,0);break;case 11:"right"==this.type_?this.modifyBarOff(0,this.posH_/3/10):s&&this.modifyBarOff(this.posW_/3/10,0);break;case 1:s&&(this.touchDown_=!0,"right"==this.type_?(i-this.posY_<this.barOff_||i-this.posY_>this.barOff_+this.posH_/3)&&(this.barOff_=i-this.posY_-this.posH_/3/2,this.modifyBarOff(0,0)):(e-this.posX_<this.barOff_||e-this.posX_>this.barOff_+this.posW_/3)&&(this.barOff_=e-this.posX_-this.posW_/3/2,this.modifyBarOff(0,0)),this.touchPos_={x:e,y:i});break;case 2:this.touchDown_&&(this.modifyBarOff(e-this.touchPos_.x,i-this.touchPos_.y),this.touchPos_.x=e,this.touchPos_.y=i);break;case 3:this.touchDown_=!1}return s}}}},380:(t,e,i)=>{const{X2DFast:s}=i(319);t.exports={XSelect:class{constructor(t,e){this.pm2f_=s.gi(),this.resetList(t,e),this.open_=!1,this.nameColor_=4294967295,this.backgroundColor_=4281413937,this.tmpSelect_=-1,this.selectCallback=null}resetList(t,e){this.list_=t,this.default_=e}move(t,e,i,s){return this.posX_=t,this.posY_=e,this.posW_=i,this.posH_=s,this}setColor(t,e){this.nameColor_=e,this.backgroundColor_=t}draw(){let t=this.posX_,e=this.posY_,i=this.posW_,s=this.posH_;this.pm2f_.fillRect(t,e,i,s,this.backgroundColor_);let o="...";if(-1!=this.default_.indexOf("\\")){let t=this.default_.split("\\");if(t.length>3)for(let e=t.length-3;e<t.length;e++)o+=t[e],e!=t.length-1&&(o+="\\");else o=this.default_}else o=this.default_;if(this.pm2f_.drawText(o,16,t,e,1,1,0,-1,-1,this.nameColor_),this.open_){this.pm2f_.fillRect(t,e+s,i,20*this.list_.length,this.backgroundColor_);for(let o in this.list_){o==this.tmpSelect_&&this.pm2f_.fillRect(t,e+s+20*o,i,20,this.backgroundColor_+3158064);let l="...";if(-1!=this.list_[o].indexOf("\\")){let t=this.list_[o].split("\\");if(t.length>3)for(let e=t.length-3;e<t.length;e++)l+=t[e],e!=t.length-1&&(l+="\\");else l=this.list_[o]}else l=this.list_[o];this.pm2f_.drawText(l,16,t,e+s+20*o,1,1,0,-1,-1,this.nameColor_)}}}isTouchIn(t,e){return!(t<this.posX_||e<this.posY_||t>this.posX_+this.posW_||e>this.posY_+this.posH_+(this.open_?20*this.list_.length:0))}onTouch(t,e,i){let s=this.isTouchIn(e,i);switch(t){case 1:if(!s)break;if(!this.open_){this.open_=!0;break}this.tmpSelect_>=0&&this.tmpSelect_<=this.list_.length&&this.default_!=this.list_[this.tmpSelect_]&&(this.default_=this.list_[this.tmpSelect_],null!=this.selectCallback&&this.selectCallback(this.default_)),this.open_=!1;break;case 2:s&&this.open_&&(this.tmpSelect_=parseInt((i-this.posY_-this.posH_)/20))}return s}registCallback(t){this.selectCallback=t}}}},319:(t,e,i)=>{"use strict";i.r(e),i.d(e,{X2DFast:()=>p});class s{constructor(){this.unit()}Get(){return this.mat}unit(){return this.mat=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this}copy(t){for(let e=0;e<4;e++)for(let i=0;i<4;i++)this.mat[e][i]=t.mat[e][i]}initRotateMatX(t){this.unit();let e=Math.cos(t),i=Math.sin(t);this.mat[1][1]=e,this.mat[1][2]=-i,this.mat[2][1]=i,this.mat[2][2]=e}initRotateMatY(t){this.unit();let e=Math.cos(t),i=Math.sin(t);this.mat[0][0]=e,this.mat[0][2]=-i,this.mat[2][0]=i,this.mat[2][2]=e}initRotateMatZ(t){this.unit();let e=Math.cos(t),i=Math.sin(t);this.mat[0][0]=e,this.mat[0][1]=-i,this.mat[1][0]=i,this.mat[1][1]=e}initScaleMat(t,e,i){this.unit(),this.mat[0][0]=t,this.mat[1][1]=e,this.mat[2][2]=i}move(t,e,i=0){return this.mat[3][0]+=t,this.mat[3][1]+=e,this.mat[3][2]+=i,this}rotate(t,e,i){return 0!=t&&(o.initRotateMatX(t*Math.PI/180),this.mult(o)),0!=e&&(o.initRotateMatY(e*Math.PI/180),this.mult(o)),0!=i&&(o.initRotateMatZ(i*Math.PI/180),this.mult(o)),this}scale(t,e,i=1){return o.initScaleMat(t,e,i),this.mult(o),this}mult(t){let e=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];for(let i=0;i<4;i++)for(let s=0;s<4;s++)e[i][s]=this.mat[i][0]*t.mat[0][s]+this.mat[i][1]*t.mat[1][s]+this.mat[i][2]*t.mat[2][s]+this.mat[i][3]*t.mat[3][s];return this.mat=e,this}MultRight(t){return this.mat=np.dot(t.mat,this.mat),this}PerspectiveMatrix(t,e,i=-1,s=-1){-1==i&&(i=Scr.logicw),-1==s&&(s=Scr.logich);let o=i/(2*tan(30*pi/180));return this.unit(),this.mat[0][0]=2/i,this.mat[1][1]=2/s,this.mat[2][2]=1/(e-t),this.mat[2][3]=1/o,this.mat[3][2]=-t/(e-t),this.mat[3][3]=1,o}orthoMat(t,e,i,s){this.move(-i/2-t,-s/2-e,0),this.scale(2/i,-2/s,0)}Make2DTransformMat(t=0,e=0,i=1,s=1,o=0,l=0,r=0,h=0,n=0){this.unit(),-1==l&&(l=0),-2==l&&(l=h/2),-3==l&&(l=h),-1==r&&(r=0),-2==r&&(r=n/2),-3==r&&(r=n),0==l&&0==r||this.move(-l,-r,0),1==i&&1==s||this.scale(i,s,1),0!=o&&this.rotate(0,0,o),0==t&&0==e||this.move(t,e,0)}Make2DTransformMat_(t,e,i,s,o,l=0,r=0){return this.unit(),0==t&&0==e||this.move(-t,-e,0),0!=o&&this.rotate(0,0,-o),1==i&&1==s||this.scale(1/i,1/s,1),this}}var o=new s,l=i(413);const{shaderFastVs:r,shaderFastFs:h}=i(498),{NapiLog:n}=i(324);class a{static gi(){return null==a.pinstance_&&(a.pinstance_=new a),a.pinstance_}constructor(){this.pUseingShader=null,this.shaders=[],this.initFastShader()}initFastShader(){this.shaderFast={program:this.initShader(r,h)},this.shaderFast.position=l.gl.getAttribLocation(this.shaderFast.program,"position"),this.shaderFast.aTexCoord=l.gl.getAttribLocation(this.shaderFast.program,"aTexCoord"),this.shaderFast.ext1=l.gl.getAttribLocation(this.shaderFast.program,"ext1"),this.shaderFast.ext2=l.gl.getAttribLocation(this.shaderFast.program,"ext2"),this.shaderFast.inColor=l.gl.getAttribLocation(this.shaderFast.program,"inColor"),this.shaderFast.uMat=l.gl.getUniformLocation(this.shaderFast.program,"uMat"),this.shaderFast.tex={};for(let t=0;t<16;t++)this.shaderFast.tex[t]=l.gl.getUniformLocation(this.shaderFast.program,"tex"+t);this.shaders[a.ID_SHADER_FAST]=this.shaderFast,this.use(a.ID_SHADER_FAST)}use(t){return l.gl.useProgram(this.shaders[t].program),this.pUseingShader=this.shaders[t],this.pUseingShader}initShader(t,e){var i=l.gl.createShader(l.gl.VERTEX_SHADER);if(l.gl.shaderSource(i,t),l.gl.compileShader(i),!l.gl.getShaderParameter(i,l.gl.COMPILE_STATUS))return n.logError("error occured compiling the shaders:"+l.gl.getShaderInfoLog(i)),null;var s=l.gl.createShader(l.gl.FRAGMENT_SHADER);if(l.gl.shaderSource(s,e),l.gl.compileShader(s),!l.gl.getShaderParameter(s,l.gl.COMPILE_STATUS))return n.logError("error occured compiling the shaders:"+l.gl.getShaderInfoLog(s)),null;var o=l.gl.createProgram();if(l.gl.attachShader(o,i),l.gl.attachShader(o,s),l.gl.linkProgram(o),l.gl.getProgramParameter(o,l.gl.LINK_STATUS))return l.gl.deleteShader(i),l.gl.deleteShader(s),o;n.logError("unable to initialize!")}}a.ID_SHADER_FAST=2,a.pinstance_=null;var c=i(245),d=i(181),u=i(631);class p{static gi(){return null==p.px2f&&(p.px2f=new p),p.px2f}constructor(){this.localBuffer=l.gl.createBuffer(),this.texSampleIdx=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],this.vertexArray=new ArrayBuffer(8388608),this.vertexFloat32=new Float32Array(this.vertexArray),this.vertexUint32=new Uint32Array(this.vertexArray),this.whiteImg=d.XTexture.gi().loadTextureFromImage("CUSTOM_TEXTURE_1"),this.whiteCut=d.XTexture.gi().makeCut(this.whiteImg,0,0,1,1),a.gi(),this.resetMat()}resetMat(){p.transform2D.unit(),p.transform2D.orthoMat(0,0,c.Scr.logicw,c.Scr.logich);let t=p.transform2D.mat;this.t2dExt=[t[0][0],t[1][0],t[2][0],t[3][0],t[0][1],t[1][1],t[2][1],t[3][1],t[0][2],t[1][2],t[2][2],t[3][2],t[0][3],t[1][3],t[2][3],t[3][3]]}swapMode2D(){l.gl.disable(l.gl.DEPTH_TEST),l.gl.enable(l.gl.BLEND),l.gl.blendFunc(l.gl.SRC_ALPHA,l.gl.ONE_MINUS_SRC_ALPHA)}DrawCircle(t,e,i,s,o=4294967295,l=1){let r=-1,h=-1,n=0,a=2*Math.PI/32;for(;n<2*Math.PI+1e-5;){let c=Math.cos(n)*i+t,d=Math.sin(n)*s+e;-1!=r&&this.drawLine(r,h,c,d,o,l),r=c,h=d,n+=a}}fillRect(t,e,i,s,o=4294967295){this.drawCut(this.whiteCut,t,e,i,s,0,0,0,o)}drawLine(t,e,i,s,o=4294967295,l=1){t=parseInt(t),e=parseInt(e),i=parseInt(i),s=parseInt(s),this.drawCut(this.whiteCut,t,e,(0,u.iDistance)(t-i,e-s),l,(0,u.fAngle)(i-t,s-e),0,0,o)}drawRect(t,e,i,s,o=4294967295,l=1){this.drawLine(t-l/2,e,t+i+l/2,e,o,l),this.drawLine(t,e,t,e+s,o,l),this.drawLine(t+i,e+s,t+i,e,o,l),this.drawLine(t+i+l/2,e+s,t-l/2,e+s,o,l)}static testTransform(t,e,i,s,o,l,r,h,n){p.tmpMat.unit(),-1==l&&(l=0),-2==l&&(l=Math.floor(h/2)),-3==l&&(l=h),-1==r&&(r=0),-2==r&&(r=Math.floor(n/2)),-3==r&&(r=n),0==l&&0==r||p.tmpMat.move(-l,-r,0),1==i&&1==s||p.tmpMat.scale(i,s,1),0!=o&&p.tmpMat.rotate(0,0,o),0==t&&0==e||p.tmpMat.move(t,e,0)}clearBuffer(){this.ridDict={},this.ridPoint=0,this.drawCount=0}swapC(t){let e,i,s,o;return isNaN(t)?(e=Math.floor(63*t[0]/255),i=Math.floor(63*t[1]/255),s=Math.floor(63*t[2]/255),o=Math.floor(63*t[3]/255)):(-1==t&&(t=4294967295),e=Math.floor(63*(t>>16&255)/255),i=Math.floor(63*(t>>8&255)/255),s=Math.floor(63*(255&t)/255),o=Math.floor(63*(t>>24&255)/255)),64*(64*(64*o+e)+i)+s+.1}drawCut_(t,e,i,s,o,l,r,h,n=4294967295){n=this.swapC(n),this.vertexFloat32.set([0,0,0,t.u0,t.v0,e,i,s,o,l,r,h,this.ridDict[t.rid],n,t.w,0,0,t.u1,t.v1,e,i,s,o,l,r,h,this.ridDict[t.rid],n,t.w,t.h,0,t.u2,t.v2,e,i,s,o,l,r,h,this.ridDict[t.rid],n,0,0,0,t.u0,t.v0,e,i,s,o,l,r,h,this.ridDict[t.rid],n,t.w,t.h,0,t.u2,t.v2,e,i,s,o,l,r,h,this.ridDict[t.rid],n,0,t.h,0,t.u3,t.v3,e,i,s,o,l,r,h,this.ridDict[t.rid],n],14*this.drawCount*6),this.drawCount+=1}drawCutEx(t,e,i=4294967295){let s=d.XTexture.pinstance_.allCuts[t];s.rid in this.ridDict||(this.ridDict[s.rid]=this.ridPoint,this.ridPoint+=1),e=e.mat,this.drawCut(s,e[0][0],e[0][1],e[1][0],e[1][1],e[2][2],e[3][0],e[3][1],i)}drawCut(t,e=0,i=0,s=1,o=1,l=0,r=0,h=0,n=4294967295){let a=parseInt(e),c=parseInt(i),u=d.XTexture.gi().allCuts[t];if(null==u)return;u.rid in this.ridDict||(this.ridPoint>=16&&(this.freshBuffer(),this.clearBuffer()),this.ridDict[u.rid]=this.ridPoint,this.ridPoint+=1),p.testTransform(a,c,s,o,l,r,h,u.w,u.h);let f=p.tmpMat.mat;this.drawCut_(u,f[0][0],f[0][1],f[1][0],f[1][1],f[2][2],f[3][0],f[3][1],n)}drawText(t,e=14,i=0,s=0,o=1,l=1,r=0,h=0,n=0,a=4294967295){if(t.length<=0)return 0;let c=d.XTexture.gi().getText(t,e);return c>=0&&this.drawCut(c,i,s,o,l,r,h,n,a),d.XTexture.gi().allCuts[c].w}getTextWidth(t,e){if(t.length<=0)return 0;let i=d.XTexture.gi().getText(t,e);return d.XTexture.gi().allCuts[i].w}freshBuffer(){if(d.XTexture.gi()._FreshText(),0==this.drawCount)return;let t=a.gi().use(a.ID_SHADER_FAST);for(let e in this.ridDict)l.gl.activeTexture(l.gl.TEXTURE0+this.ridDict[e]),l.gl.bindTexture(l.gl.TEXTURE_2D,d.XTexture.gi().ximages[e].tex),l.gl.uniform1i(t.tex[this.ridDict[e]],this.ridDict[e]);l.gl.uniformMatrix4fv(t.uMat,!1,this.t2dExt),l.gl.bindBuffer(l.gl.ARRAY_BUFFER,this.localBuffer),l.gl.bufferData(l.gl.ARRAY_BUFFER,this.vertexArray,l.gl.STATIC_DRAW),l.gl.vertexAttribPointer(t.position,3,l.gl.FLOAT,!1,56,0),l.gl.enableVertexAttribArray(t.position),l.gl.vertexAttribPointer(t.aTexCoord,2,l.gl.FLOAT,!1,56,12),l.gl.enableVertexAttribArray(t.aTexCoord),l.gl.vertexAttribPointer(t.ext1,4,l.gl.FLOAT,!1,56,20),l.gl.enableVertexAttribArray(t.ext1),l.gl.vertexAttribPointer(t.ext2,4,l.gl.FLOAT,!1,56,36),l.gl.enableVertexAttribArray(t.ext2),l.gl.vertexAttribPointer(t.inColor,1,l.gl.FLOAT,!1,56,52),l.gl.enableVertexAttribArray(t.inColor),l.gl.drawArrays(l.gl.TRIANGLES,0,6*this.drawCount)}}p.tmpMat=new s,p.transform2D=new s,p.px2f=null},181:(t,e,i)=>{"use strict";i.r(e),i.d(e,{XTexture:()=>o});var s=i(413);class o{static gi(){return null==o.pinstance_&&(o.pinstance_=new o),o.pinstance_}constructor(){this.ximages=[],this.allCuts={},this.tmpCutid=0,this.aiCutid=100,this.textImgs={},this.textIdxs={},this.textTmpRid=this.loadTexture(1024,256),this.bfirst=!0,this.textCvs=document.createElement("canvas"),this.textCvs.width=1024,this.textCvs.height=256,this.textCtx=this.textCvs.getContext("2d",{willReadFrequently:!0}),this.textCtx.textBaseline="top",this.textCtx.textAlign="left"}static initTextureStatus(t){s.gl.activeTexture(s.gl.TEXTURE0),s.gl.bindTexture(s.gl.TEXTURE_2D,t),s.gl.pixelStorei(s.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MIN_FILTER,s.gl.NEAREST),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MAG_FILTER,s.gl.NEAREST),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_WRAP_S,s.gl.CLAMP_TO_EDGE),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_WRAP_T,s.gl.CLAMP_TO_EDGE)}loadTextureFromImage(t,e=!1){if("CUSTOM_TEXTURE_1"==t){var i=this.ximages.length,l=s.gl.createTexture();o.initTextureStatus(l);let e=new Uint8Array([255,255,255,255]);return s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.RGBA,1,1,0,s.gl.RGBA,s.gl.UNSIGNED_BYTE,e),this.ximages[i]={stat:1,path:t,tex:l,w:1,h:1},i}for(let e=0;e<this.ximages.length;e++)if(this.ximages[e].path==t)return e;i=this.ximages.length,this.ximages[i]={stat:0,path:t,tex:null};var r=new Image;return r.src=t,r.onload=function(){var t=s.gl.createTexture();o.initTextureStatus(t),s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.RGBA,s.gl.RGBA,s.gl.UNSIGNED_BYTE,r),o.pinstance_.ximages[i].tex=t,o.pinstance_.ximages[i].img=r,o.pinstance_.ximages[i].stat=1,o.pinstance_.ximages[i].w=r.width,o.pinstance_.ximages[i].h=r.height},i}TmpCut(t,e=0,i=0,s=-1,o=-1,l=1024,r=1024){return 1!=this.ximages[t].stat?-1:(-1==s&&(s=l),-1==o&&(o=r),this.allCuts[this.tmpCutid]={rid:t,x:e,y:i,w:s,h:o,u0:e/l,v0:i/r,u1:(e+s)/l,v1:i/r,u2:(e+s)/l,v2:(i+o)/r,u3:e/l,v3:(i+o)/r},this.tmpCutid+=1,this.tmpCutid-1)}makeCut(t,e=0,i=0,s=-1,o=-1,l=-1,r=-1){return-1==l&&(l=this.ximages[t].w),-1==r&&(r=this.ximages[t].h),-1==s&&(s=l),-1==o&&(o=r),this.allCuts[this.aiCutid]={rid:t,x:e,y:i,w:s,h:o,u0:e/l,v0:i/r,u1:(e+s)/l,v1:i/r,u2:(e+s)/l,v2:(i+o)/r,u3:e/l,v3:(i+o)/r},this.aiCutid+=1,this.aiCutid-1}timenow(){return(new Date).getTime()/1e3}PutTexture(t,e,i){var s=this.ximages.length;return this.ximages[s]={stat:1,path:"put"+s,tex:t,w:e,h:i},s}loadTexture(t,e){var i=this.ximages.length,l=s.gl.createTexture();return o.initTextureStatus(l),s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.RGBA,t,e,0,s.gl.RGBA,s.gl.UNSIGNED_BYTE,null),this.ximages[i]={stat:1,path:"default"+i,tex:l,w:t,h:e},i}initTextImageData(t,e){this.textCtx.clearRect(0,0,1024,256),this.textCtx.font=e+"px '宋体'",this.textCtx.fillStyle="rgba(255,255,255,1)",this.textCtx.fillText(t,1,1);let i=this.textCtx.getImageData(0,0,1024,256).data,s=1024,o=e+5,l=256;for(;256==l;)for(o-=1,l=0;l<128&&0==i[4*(1024*o+l)];l++);let r=o;for(;r==o;)for(s-=1,r=0;r<o&&0==i[4*(1024*r+s)];r++);return this.textCtx.getImageData(0,0,s+1,o+1)}getText(t,e){let i=t+e;if(i in this.textIdxs)return this.textIdxs[i].time=this.timenow(),this.textIdxs[i].cid;let o=this.initTextImageData(t,e),l=o.width,r=o.height,h=Math.floor((r+31)/32),n=0;for(let t=0;t<h;t++)n|=1<<t;let a=-1,c=-1;for(let t in this.textImgs){for(let e=0;e<32-h+1;e++)if(0==(this.textImgs[t].mask&n<<e)){c=e;break}if(-1!=c){a=t;break}}-1==a&&(a=this.loadTexture(1024,1024),this.textImgs[a]={mask:0},c=0);let d=this.makeCut(a,0,32*c,l,r);return this.textImgs[a].mask|=n<<c,this.textIdxs[i]={cid:d,rid:a,mask:n<<c,time:this.timenow()},s.gl.activeTexture(s.gl.TEXTURE0),s.gl.bindTexture(s.gl.TEXTURE_2D,this.ximages[a].tex),s.gl.pixelStorei(s.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.gl.texSubImage2D(s.gl.TEXTURE_2D,0,0,32*c,s.gl.RGBA,s.gl.UNSIGNED_BYTE,o),d}_FreshText(){this.tmpCutid=0;let t=this.timenow(),e=[];for(let i in this.textIdxs)t-this.textIdxs[i].time>3&&(this.textImgs[this.textIdxs[i].rid].mask&=~this.textIdxs[i].mask,delete this.allCuts[this.textIdxs[i].cid],e.push(i));for(let t in e)delete this.textIdxs[e[t]]}static ExpandColor(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255,(t>>24&255)/255]}}o.pinstance_=null},498:t=>{t.exports={shaderFastVs:"\nattribute vec3 position;\nattribute vec2 aTexCoord;\nattribute vec4 ext1;//x,y,sw,sh,\nattribute vec4 ext2;//ra,ox,oy,i\nattribute float inColor;\nuniform mat4 uMat;\n\nvarying vec2 TexCoord;\nvarying float tex_point;\nvarying vec4 clr_filter;\nvoid main()\n{\n    mat4 tmpMat=mat4(ext1[0],ext1[2],0.0,ext2[1],\n                      ext1[1],ext1[3],0.0,ext2[2],\n                      0.0,0.0,ext2[0],0.0,\n                      0.0,0.0,0.0,1.0);\n    \n    vec4 tv=vec4(position.x, position.y, position.z, 1.0)*tmpMat*uMat;\n    gl_Position = tv;\n    TexCoord = aTexCoord;\n    tex_point = ext2[3];\n\n    clr_filter=vec4(0.0,0.0,0.0,1.0);\n    int tt=int(inColor);\n\n    int tt1=tt-tt/64*64;\n    clr_filter.b=0.015873015873*float(tt1);\n    tt=tt/64;\n\n    int tt2=tt-tt/64*64;\n    clr_filter.g=0.015873015873*float(tt2);\n    tt=tt/64;\n\n    int tt3=tt-tt/64*64;\n    clr_filter.r=0.015873015873*float(tt3);\n    tt=tt/64;\n    \n    clr_filter.a=0.015873015873*float(tt-tt/64*64);\n}\n",shaderFastFs:"\nprecision mediump float;\n\nvarying vec2 TexCoord;\nvarying float tex_point;\nvarying vec4 clr_filter;\nuniform sampler2D tex0;\nuniform sampler2D tex1;\nuniform sampler2D tex2;\nuniform sampler2D tex3;\nuniform sampler2D tex4;\nuniform sampler2D tex5;\nuniform sampler2D tex6;\nuniform sampler2D tex7;\nuniform sampler2D tex8;\nuniform sampler2D tex9;\nuniform sampler2D tex10;\nuniform sampler2D tex11;\nuniform sampler2D tex12;\nuniform sampler2D tex13;\nuniform sampler2D tex14;\nuniform sampler2D tex15;\n\nvoid main()\n{\n    if(tex_point<0.5)gl_FragColor = texture2D(tex0, TexCoord);\n    else if(tex_point<1.5)gl_FragColor = texture2D(tex1, TexCoord);\n    else if(tex_point<2.5)gl_FragColor = texture2D(tex2, TexCoord);\n    else if(tex_point<3.5)gl_FragColor = texture2D(tex3, TexCoord);\n    else if(tex_point<4.5)gl_FragColor = texture2D(tex4, TexCoord);\n    else if(tex_point<5.5)gl_FragColor = texture2D(tex5, TexCoord);\n    else if(tex_point<6.5)gl_FragColor = texture2D(tex6, TexCoord);\n    else if(tex_point<7.5)gl_FragColor = texture2D(tex7, TexCoord);\n    else if(tex_point<8.5)gl_FragColor = texture2D(tex8, TexCoord);\n    else if(tex_point<9.5)gl_FragColor = texture2D(tex9, TexCoord);\n    else if(tex_point<10.5)gl_FragColor = texture2D(tex10, TexCoord);\n    else if(tex_point<11.5)gl_FragColor = texture2D(tex11, TexCoord);\n    else if(tex_point<12.5)gl_FragColor = texture2D(tex12, TexCoord);\n    else if(tex_point<13.5)gl_FragColor = texture2D(tex13, TexCoord);\n    else if(tex_point<14.5)gl_FragColor = texture2D(tex14, TexCoord);\n    else if(tex_point<15.5)gl_FragColor = texture2D(tex15, TexCoord);\n    gl_FragColor=gl_FragColor * clr_filter;\n}"}},37:t=>{class e{static FOCUS=!1;static SAFE_AREA=[];static SetSafeArea(t,i,s,o){e.SAFE_AREA=[t,i,s,o]}static Reset(t,i,s,o,l,r,h,n){e.SAFE_AREA=[t,i,s,o];let a=document.getElementById("canvas_textarea");a.style.left=t+"px",a.style.top=i+"px",a.style.width=s+"px",a.style.height=o+"px",a.style.display="block",a.value=l,a.onchange=t=>{r&&r(t.target.value)},a.oninput=t=>{h&&h(t.target.value)},a.focus(),a.addEventListener("keydown",(t=>{"Enter"==t.key&&(console.log(t),t.preventDefault(),n&&n())})),e.FOCUS=!0}static HideEx(){document.getElementById("canvas_textarea").style.display="none",e.FOCUS=!1}}t.exports={CanvasInput:e}},244:(t,e,i)=>{const{X2DFast:s}=i(319);class o{static NONE=0;static CONTROL=1;static DEPEND=2;static VALUE=4;static FRAMESTATE=8;static ROOT=16;static OTHER=32}t.exports={IrToPicture:class{static INVALID_DEEP=-99999;static NODEH=20;static LINE_TYPE=["state","depend","value","framestate","root"];static nodeType(t){return"STATE_ENTRY"==t.op||t.in[0].length>0&&-1==["VALUE_SELECTOR","DEPEND_SELECTOR","DEPEND_RELAY","LOOP_EXIT_DEPEND","LOOP_EXIT_VALUE","STATE_SPLIT","GET_EXCEPTION"].indexOf(t.op)?"control":"DEPEND_ENTRY"==t.op||t.in[1].length>0?"depend":"ARG"==t.op||"CONSTANT"==t.op||"CONST_DATA"==t.op||t.in[2].length>0?"value":"other"}static nodeTypeMask(t){let e=o.NONE;return"STATE_ENTRY"==t.op&&(e|=o.CONTROL),t.in[0].length>0&&-1==["VALUE_SELECTOR","DEPEND_SELECTOR","DEPEND_RELAY","LOOP_EXIT_DEPEND","LOOP_EXIT_VALUE","STATE_SPLIT","GET_EXCEPTION"].indexOf(t.op)&&(e|=o.CONTROL),("DEPEND_ENTRY"==t.op||t.in[1].length>0)&&(e|=o.DEPEND),("ARG"==t.op||"CONSTANT"==t.op||"CONST_DATA"==t.op||t.in[2].length>0)&&(e|=o.VALUE),("FRAME_STATE"==t.op||t.in[3].length>0)&&(e|=o.FRAMESTATE),("CIRCUIT_ROOT"==t.op||t.in[4].length>0)&&(e|=o.ROOT),e==o.NONE&&(e=o.OTHER),e}static isLoopBack(t,e){return"LOOP_BEGIN"==e[t.toId].ir.op&&t.fromId==e[t.toId].ir.in[0][1]||"DEPEND_SELECTOR"==e[t.toId].ir.op&&t.fromId==e[t.toId].ir.in[1][1]||"VALUE_SELECTOR"==e[t.toId].ir.op&&t.fromId==e[t.toId].ir.in[2][1]}static toPicture(t,e,i){let o={},l=-1;for(let i of t){if(0==e&&"control"!=this.nodeType(i))continue;let t=i.id+","+i.op;"JS_BYTECODE"==i.op&&(t=i.id+","+i.bytecode),o[i.id]={type:this.nodeType(i),mask:this.nodeTypeMask(i),hide:!1,inCount:0,in:[],inh:{},outCount:0,out:[],outh:[],pos:{x:-1,y:-1},deep:this.INVALID_DEEP,name:t,nameWidth:s.gi().getTextWidth(t,14),ir:i},-1==l&&(l=i.id)}let r=[],h=0;for(let t in o){let e=parseInt(t);for(let t=0;t<o[e].ir.in.length;t++)for(let i=0;i<o[e].ir.in[t].length;i++){let s=o[e].ir.in[t][i];if(s in o){let l={lid:h++,lineType:this.LINE_TYPE[t],inNum:o[e].inCount,outNum:o[s].outCount,fromId:s,toId:e,inP1:t,inP2:i,outP:o[s].ir.out.indexOf(e),used:!1};o[e].inCount++,o[e].in.push(l),o[s].outCount++,o[s].out.push(l),r.push(l)}}}return this.resetPicture(o,i),{nodes:o,lines:r}}static deepTest(t,e,i,s,o){try{s.push(t.ir.id)}catch(t){console.log(1)}if(s.length>2*Object.keys(e).length)return!0;if(s.length>1&&t.ir.id==o)return!0;for(let l=0;l<t.out.length;l++){let r=e[t.out[l].toId];if(t.deep!=this.INVALID_DEEP){if(r.deep==this.INVALID_DEEP&&(r.deep=t.deep+1,this.deepTest(r,e,i,s,o)))return!0;if(r.deep<=t.deep&&!this.isLoopBack(t.out[l],e)&&!i&&(r.deep=t.deep+1,this.deepTest(r,e,i,s,o)))return!0}}return s.pop(),!1}static checkoutLoop(t){console.log(JSON.stringify(t));let e={};for(let i of t)i in e?e[i]++:e[i]=1;console.log(JSON.stringify(e,null,4))}static TEST_LOOP=!0;static resetPicture(t,e){if(this.TEST_LOOP&&Object.keys(t).length>0){for(let e in t)t[e].deep=0==e?0:this.INVALID_DEEP;let i=[];this.deepTest(t[0],t,e,i,0),i.length>0&&this.checkoutLoop(i)}let i=!0,s=[];for(let e in t){let o=t[e];o.hide||(i?(o.pos.x=0,o.pos.y=0,o.deep=0,i=!1,s.push(e)):o.deep=this.INVALID_DEEP)}let o=[];for(;s.length>0;){let i=[];for(let o=0;o<s.length;o++){let l=t[s[o]];if(!l.hide){for(let s=0;s<l.out.length;s++){let o=t[l.out[s].toId];l.deep!=this.INVALID_DEEP&&(o.deep==this.INVALID_DEEP&&(o.deep=l.deep+1,i.push(o.ir.id)),o.deep<=l.deep&&(this.isLoopBack(l.out[s],t)||e||(o.deep=l.deep+1,i.push(o.ir.id))))}for(let s=0;s<l.in.length;s++){let o=t[l.in[s].fromId];l.deep!=this.INVALID_DEEP&&(o.deep==this.INVALID_DEEP&&(o.deep=l.deep-1,i.push(o.ir.id)),o.deep>=l.deep&&(this.isLoopBack(l.in[s],t)||e||(l.deep=o.deep+1,i.push(l.ir.id))))}}}o.push(s),s=i}let l={};for(let e in t){let i=t[e];i.hide||(i.deep in l||(l[i.deep]=[]),l[i.deep].push(i))}let r=50;for(let e in t){let i=t[e],s=[];for(let t of i.out)s.indexOf(t.lineType)<0&&s.push(t.lineType);i.ltypes=s,i.hide||i.deep==this.INVALID_DEEP&&(i.pos.x=this.INVALID_DEEP,i.pos.y=r,r+=50)}let h=0,n=Object.keys(l).sort(((t,e)=>parseInt(t)-parseInt(e)));for(let t of n){if(t=parseInt(t),t==this.INVALID_DEEP)continue;let e=0,i=0,s=0;for(let o=0;o<l[t].length;o++){let r=l[t];if(!r.hide){for(let t=0;t<r[o].in.length;t++){let e=r[o].in[t];r[o].inh[e.fromId+e.lineType]||(r[o].inh[e.fromId+e.lineType]=5*(s+1),s+=1)}e+=Object.keys(r[o].inh).length,i+=r[o].ltypes.length}}h+=5*(e+1);let o=0;for(let e=0;e<l[t].length;e++){let i=l[t];if(!i.hide){for(let t=0;t<i[e].out.length;t++)i[e].outh[t]=5*(o+1+i[e].ltypes.indexOf(i[e].out[t].lineType));i[e].pos.y=h,o+=i[e].ltypes.length}}h+=5*(i+1)+this.NODEH;let r=0;for(let e=0;e<l[t].length;e++)r+=l[t][e].nameWidth+20;let n=-r/2;for(let e=0;e<l[t].length;e++)l[t][e].pos.x=n+10,n+=l[t][e].nameWidth+20}}}}},534:(t,e,i)=>{const{Scr:s}=i(245),{XTools:o}=i(631),{XButton:l}=i(905),{XScroll:r}=i(215),{XSelect:h}=i(380),{X2DFast:n}=i(319),{XTexture:a}=i(181),{CanvasInput:c}=i(37),{IrToPicture:d}=i(244),{LogParser:u}=i(108),{NapiLog:p}=i(324),f=["state","depend","value","framestate","root","other"];t.exports={IrViewer:class{constructor(t,e){this.t1_=Date.now(),this.fileName_=t,this.parser_=new u(e),this.inited_=!1}InitViewer(t){this.data_=t,this.direct_=null,this.selectPoint_=[],this.visable_=null,this.loaded_=!1,this.offx_=s.logicw/2,this.offy_=30;let e=10,i=10,o=Object.keys(this.data_);this.selectFile_=new h(o,o[0]),this.selectFile_.move(e,i,550,20),this.selectFile_.registCallback(this.changeFile.bind(this)),e=10,i+=30,this.selectFunc_=new h([],""),this.selectFunc_.move(e,i,290,20),this.selectFunc_.registCallback(this.changeFunc.bind(this)),e+=300,this.selectMethod_=new h([],""),this.selectMethod_.move(e,i,250,20),this.selectMethod_.registCallback(this.changeMethod.bind(this)),e=10,i+=30,this.btnGo_=[],this.mask_=65535;for(let t=0;t<f.length;t++){let s=f[t]+"✔️",o=n.gi().getTextWidth(s,14)+6,r=new l(e,i,o,20,s);r.inTypeId_=t,r.inTypeMask_=1,r.onClicked_=()=>{r.inTypeMask_=1-r.inTypeMask_,r.name_=f[r.inTypeId_]+(1==r.inTypeMask_?"✔️":"❌"),this.mask_=this.mask_&~(1<<r.inTypeId_)|r.inTypeMask_<<r.inTypeId_,this.changeVisable()},this.btnGo_.push(r),e+=o+10}e=10,i+=30;let a=[["隐藏选中",()=>{this.hideNode(0)}],["隐藏未选中",()=>{this.hideNode(1)}],["显示隐藏",()=>{this.hideNode(2)}],["选中前继",()=>{this.selectNode(0)}],["选中后继",()=>{this.selectNode(1)}],["刷新",()=>{this.freshNode()}]];for(let t of a){let s=n.gi().getTextWidth(t[0],14)+6,o=new l(e,i,s,20,t[0]);o.onClicked_=t[1],this.btnGo_.push(o),e+=s+10}this.btnGo_.push(this.selectFile_,this.selectFunc_,this.selectMethod_),this.btnGo_.sort(((t,e)=>e.posY_-t.posY_)),this.scrollY_=new r({type:"right"}),this.scrollX_=new r({type:"button"}),this.scrollY_.move(s.logicw-20,100,20,s.logich-100-20),this.scrollX_.move(20,s.logich-20,s.logicw-40,20),this.hideNodeIds_=[],this.pointFile_=o[0]}freshNode(){this.scrollY_.setBarOff(0),this.scrollX_.setBarOff(.5),d.resetPicture(this.visable_.nodes,this.direct_.type.startsWith("block:"))}hideNode(t){if(0==t)this.hideNodeIds_=this.hideNodeIds_.concat(this.selectPoint_);else if(1==t){let t=this.visable_.nodes;for(let e in t)this.selectPoint_.indexOf(parseInt(t[e].ir.id))>=0||this.hideNodeIds_.push(parseInt(t[e].ir.id))}else this.hideNodeIds_=[];this.changeVisable()}selectNode(t){let e=new Set,i=this.visable_.nodes,s=this.visable_.lines,o=!1;for(let l of s){let s=i[l.fromId],r=i[l.toId],h=parseInt(s.ir.id),n=parseInt(r.ir.id),a=-1;0==t&&0!=(s.mask&this.mask_)&&this.selectPoint_.indexOf(n)>=0&&(a=this.hideNodeIds_.indexOf(h),e.add(h)),1==t&&0!=(r.mask&this.mask_)&&this.selectPoint_.indexOf(h)>=0&&(a=this.hideNodeIds_.indexOf(n),e.add(n)),a>=0&&(this.hideNodeIds_.splice(a,1),o=!0)}this.selectPoint_=[...e],o&&this.changeVisable()}loading(){if(this.loaded_)return!1;if(this.parser_.parsing())return!0;if(!this.inited_)return this.inited_=!0,this.InitViewer(this.parser_.output_),!0;let t=1,e=1,i=1;for(let s in this.data_)for(let o in this.data_[s])for(let l of this.data_[s][o])t++,l.loaded?e++:i<=0||(i--,l.irAll=d.toPicture(l.irList,1,l.type.startsWith("block:")),l.loaded=!0);return 0==i?(o.PROC_TO=20+e/t*80,!0):(o.PROC_TO=100,this.loaded_=!0,this.changeFile(this.pointFile_),p.logInfo("load cost",Date.now()-this.t1_),!0)}changeFile(t){this.pointFile_=t;let e=Object.keys(this.data_[this.pointFile_]);this.selectFunc_.resetList(e,e[0]),this.changeFunc(e[0])}changeFunc(t){this.pointFunc_=t;let e=[];for(let t=0;t<this.data_[this.pointFile_][this.pointFunc_].length;t++)e.push(t+1+","+this.data_[this.pointFile_][this.pointFunc_][t].type);this.selectMethod_.resetList(e,e[0]),this.changeMethod(e[0])}changeMethod(t){this.pointMethod_=t;let e=parseInt(t.split(",")[0])-1;this.direct_=this.data_[this.pointFile_][this.pointFunc_][e],this.changeVisable()}changeVisable(){this.visable_=this.direct_.irAll;let t=this.visable_.nodes,e=(this.visable_.lines,[]);for(let i in t){let s=t[i];this.hideNodeIds_.indexOf(parseInt(s.ir.id))>=0?s.hide=!0:(s.hide=0==(s.mask&this.mask_),s.hide||e.push(i))}for(let i of e){let e=t[i];for(let i=0;i<5;i++)if(this.mask_&1<<i!=0&&e.mask&1<<i!=0)for(let s of e.ir.in[i])t[s].hide=!1}for(let e in t){let i=t[e];this.hideNodeIds_.indexOf(parseInt(i.ir.id))>=0&&(i.hide=!0)}this.scrollY_.setBarOff(0),this.scrollX_.setBarOff(.5)}makeLevely(t){let e=new Set;for(let i in t){let s=t[i];s.hide||s.deep!=d.INVALID_DEEP&&e.add(s.pos.y)}return Array.from(e).sort(((t,e)=>parseInt(t)-parseInt(e)))}drawSmallMap(t,e,i,l,r){if(e==i||r==l)return;let[h,a,c,d]=this.smallMapRect;n.gi().fillRect(h,a,c,d,2147483648);let u=c/(i-e),p=d/(r-l),f=Math.max(20*p,1);for(let i in t){let s=t[i];if(s.hide)continue;let r=s.pos.x-e,c=s.pos.y-l,d=Math.max((s.nameWidth+6)*u,1);if(this.selectPoint_.indexOf(parseInt(i))>=0)this.drapSelect_&&(r+=this.drapSelect_.dx,c+=this.drapSelect_.dy),n.gi().fillRect(h+(r-3)*u,a+(c-10)*p,d,f,4278190080);else{let t=!1;for(let e of s.in)if(this.selectPoint_.indexOf(parseInt(e.fromId))>=0){t=!0;break}if(!t)for(let e of s.out)if(this.selectPoint_.indexOf(parseInt(e.toId))>=0){t=!0;break}t?n.gi().fillRect(h+(r-3)*u,a+(c-10)*p,d,f,4278190080):n.gi().fillRect(h+(r-3)*u,a+(c-10)*p,d,f,o.CONFIG.NodeColor[s.type])}}n.gi().drawRect(h-(this.offx_+e)*u,a-(this.offy_+l)*p,Math.min(s.logicw*u,c),Math.min(s.logich*p,d),4278255360,1)}onDraw(){if(this.loading())return void n.gi().drawText("Loading "+o.PROC_TO.toFixed(1)+"%",20,s.logicw/2,s.logich/2,1,1,0,-2,-2,4278190080);let t=parseInt(Math.min(s.logicw/3,s.logich/3));this.smallMapRect=[s.logicw-50-t,50,t,t];let e=this.visable_.nodes,i=this.visable_.lines,l=this.makeLevely(e),r=-9999,h=9999,c=-1,u={singleCount:0,showCount:0,nodeCount:Object.keys(e).length};for(let t in e){let i=e[t];i.hide||(u.showCount++,i.deep!=d.INVALID_DEEP&&(u.singleCount++,r<i.pos.x+i.nameWidth+this.offx_&&(r=i.pos.x+i.nameWidth+this.offx_),h>i.pos.x+this.offx_&&(h=i.pos.x+this.offx_)),o.InRect(o.MOUSE_POS.x,o.MOUSE_POS.y,i.pos.x+this.offx_-3,i.pos.y+this.offy_-10,i.nameWidth+6,20)&&(c=t),i.outhx={})}this.selectLines_=[];let p=this.drawLines(this.offx_,this.offy_,e,i,l,[h-20,r+20],!1);for(let t in e){let i=e[t];if(i.deep==d.INVALID_DEEP&&i.pos.x==d.INVALID_DEEP&&(i.pos.x=p[1]-this.offx_+20),i.hide)continue;let s=i.pos.x+this.offx_,l=i.pos.y+this.offy_;if(this.selectPoint_.indexOf(parseInt(t))>=0)this.drapSelect_&&(s+=this.drapSelect_.dx,l+=this.drapSelect_.dy),n.gi().fillRect(s-3,l-10,i.nameWidth+6,20,4294967040),n.gi().drawRect(s-3,l-10,i.nameWidth+6,20,4278190080,2);else{n.gi().fillRect(s-3,l-10,i.nameWidth+6,20,o.CONFIG.NodeColor[i.type]);let t=!1;for(let e of i.in)if(this.selectPoint_.indexOf(parseInt(e.fromId))>=0){t=!0;break}if(!t)for(let e of i.out)if(this.selectPoint_.indexOf(parseInt(e.toId))>=0){t=!0;break}t&&n.gi().drawRect(s-3,l-10,i.nameWidth+6,20,4278190080,2)}n.gi().drawText(i.name,14,s+i.nameWidth/2,l+2,1,1,0,-2,-2,4278190080)}this.drawLines(this.offx_,this.offy_,e,i,l,[h-20,r+20],!0);for(let t of this.selectLines_){let[e,i,s,o]=a.ExpandColor(t[4]);e=Math.max(0,255*e-32),i=Math.max(0,255*i-32),s=Math.max(0,255*s-32),this.drawLine(t[0],t[1],t[2],t[3],4278190080|e<<16|i<<8|s,t[5]+1)}if(c>=0){let t=e[c],i=t.ir.maxDetailWidth+2,s=16*t.ir.detailList.length+2,l=o.MOUSE_POS.x-i,r=o.MOUSE_POS.y-s;l<10&&(l=10),r<130&&(r=130),n.gi().fillRect(l,r,i,s,16777215&o.CONFIG.NodeColor[t.type]|3221225472);for(let e=0;e<t.ir.detailList.length;e++)n.gi().drawText(t.ir.detailList[e],14,l+1,r+1+16*e,1,1,0,-1,-1,4278190080)}for(let t of this.btnGo_)t.draw();let f=9999,_=9999,g=-9999,x=-9999;for(let t in e){let i=e[t];i.hide||(i.pos.x<f&&(f=i.pos.x),i.pos.x+i.nameWidth>g&&(g=i.pos.x+i.nameWidth),i.pos.y<_&&(_=i.pos.y),i.pos.y+i.nameWidth>x&&(x=i.pos.y+d.NODEH))}f=Math.min(p[0]-this.offx_,f)-s.logicw/3,g=Math.max(p[1]-this.offx_,g)+s.logicw/3,_-=s.logich/3,x+=s.logich/3,this.dragScoll={x1:f,x2:g,y1:_,y2:x};let m=g-f,T=x-_;if(this.dragScoll.hh=T-s.logich,this.dragScoll.ww=m-s.logicw,this.dragScoll.hh<1&&(this.dragScoll.hh=1),this.dragScoll.ww<1&&(this.dragScoll.ww=1),this.drapBackground_?(this.scrollY_.setBarOff(-(this.offy_+this.dragScoll.y1)/this.dragScoll.hh),this.scrollX_.setBarOff(-(this.offx_+this.dragScoll.x1)/this.dragScoll.ww)):(this.offy_=-this.scrollY_.getBarOff()*this.dragScoll.hh-this.dragScoll.y1,this.offx_=-this.scrollX_.getBarOff()*this.dragScoll.ww-this.dragScoll.x1),this.dragScoll.hh>1&&this.scrollY_.move(s.logicw-20,100,20,s.logich-100-20).draw(),this.dragScoll.ww>1&&this.scrollX_.move(20,s.logich-20,s.logicw-40,20).draw(),this.drawSmallMap(e,f,g,_,x),this.searchInput){let t=this.searchInput.pos[0],e=this.searchInput.pos[1],i=this.searchInput.pos[2],s=this.searchInput.pos[3];n.gi().fillRect(t,e,i,s,2147483648);let o=0==this.searchInput.result.length?"0/0":this.searchInput.point+1+"/"+this.searchInput.result.length;this.searchInput.btnUp.move(t+20,e+50,32,24).draw(),n.gi().drawText(o,20,t+i/2,e+50+12,1,1,0,-2,-2,4294967295),this.searchInput.btnDown.move(t+i-20-32,e+50,32,24).draw(),this.searchInput.btnClose.move(t+i-40,e+10,30,30).draw()}}checkLevel(t,e,i){return t.indexOf(e.pos.y)+1==t.indexOf(i.pos.y)}drawLines(t,e,i,s,l,r,h){let n=5;n=-5;for(let t of s){let e=i[t.fromId],s=i[t.toId];if(e.hide||s.hide)continue;let o=e.pos.x+s.pos.x<-50?0:1;this.checkLevel(l,e,s)||e.outh[t.outNum]in e.outhx||(r[o]+=0==o?n:5,e.outhx[e.outh[t.outNum]]=r[o])}let a=[r[0],r[1]];for(let a of s){let s=i[a.fromId],c=i[a.toId];if(s.hide||c.hide)continue;let d=s.pos.x+s.nameWidth-5+t-5*s.ltypes.indexOf(a.lineType),u=s.pos.y+10+e,p=c.pos.x+c.nameWidth-5+t-5*a.inNum,f=c.pos.y-10+e,_=s.pos.x+c.pos.x<-50?0:1,g=!1;if((this.selectPoint_.indexOf(a.fromId)>=0||this.selectPoint_.indexOf(a.toId)>=0)&&(g=!0,this.drapSelect_&&(this.selectPoint_.indexOf(a.fromId)>=0&&(d+=this.drapSelect_.dx,u+=this.drapSelect_.dy),this.selectPoint_.indexOf(a.toId)>=0&&(p+=this.drapSelect_.dx,f+=this.drapSelect_.dy))),h!=g){this.checkLevel(l,s,c)||(r[_]+=0==_?5:n);continue}let x=4290822336,m=1;g&&(x=o.CONFIG.LineColor[a.lineType],m=2);let T=[];if(this.checkLevel(l,s,c))T.push([d,u,d,u+s.outh[a.outNum],x,m]),T.push([d,u+s.outh[a.outNum],p,u+s.outh[a.outNum],x,m]),T.push([p,u+s.outh[a.outNum],p,f,x,m]);else{let t=s.outhx[s.outh[a.outNum]],e=c.inh[a.fromId+a.lineType];T.push([d,u,d,u+s.outh[a.outNum],x,m]),T.push([d,u+s.outh[a.outNum],t,u+s.outh[a.outNum],x,m]),T.push([t,u+s.outh[a.outNum],t,f-e,x,m]),T.push([t,f-e,p,f-e,x,m]),T.push([p,f-e,p,f,x,m]),r[_]+=0==_?5:n}let E=!1;for(let t of T)E|=this.drawLine(...t);E&&this.selectLines_.push(...T)}return[Math.min(a[0],r[0]),Math.max(a[1],r[1])]}drawLine(t,e,i,s,l,r=1){if(t==i){if(e>s&&([e,s]=[s,e]),n.px2f.fillRect(t,e,r,s-e+r,l),o.InRect(o.MOUSE_POS.x,o.MOUSE_POS.y,t-1,e,r+2,s-e))return!0}else if(e==s&&(t>i&&([t,i]=[i,t]),n.px2f.fillRect(t,e,i-t,r,l),o.InRect(o.MOUSE_POS.x,o.MOUSE_POS.y,t,e-1,i-t,r+2)))return!0;return!1}locateNode(t){this.selectPoint_=[parseInt(t)];let e=this.visable_.nodes[t];this.offx_=s.logicw/2-e.pos.x,this.offy_=s.logich/2-e.pos.y,this.scrollY_.setBarOff(-(this.offy_+this.dragScoll.y1)/this.dragScoll.hh),this.scrollX_.setBarOff(-(this.offx_+this.dragScoll.x1)/this.dragScoll.ww),this.offy_=-this.scrollY_.getBarOff()*this.dragScoll.hh-this.dragScoll.y1,this.offx_=-this.scrollX_.getBarOff()*this.dragScoll.ww-this.dragScoll.x1}findNext(){this.searchInput&&(this.searchInput.point+=1,this.searchInput.point>=this.searchInput.result.length&&(this.searchInput.point=0),this.locateNode(this.searchInput.result[this.searchInput.point]))}resetOffset(t,e){let[i,o,l,r]=this.smallMapRect,[h,n,a,c]=[this.dragScoll.x1,this.dragScoll.y1,this.dragScoll.x2,this.dragScoll.y2];if(h==a||n==c)return;let d=l/(a-h),u=r/(c-n);this.offx_=(i-t+s.logicw*d/2)/d-h,this.offy_=(o-e+s.logich*u/2)/u-n,this.scrollY_.setBarOff(-(this.offy_+this.dragScoll.y1)/this.dragScoll.hh),this.scrollX_.setBarOff(-(this.offx_+this.dragScoll.x1)/this.dragScoll.ww),this.offy_=-this.scrollY_.getBarOff()*this.dragScoll.hh-this.dragScoll.y1,this.offx_=-this.scrollX_.getBarOff()*this.dragScoll.ww-this.dragScoll.x1}onTouch(t,e,i){if(this.loading())return!0;if(this.smallMapLocked_)return 2==t&&this.resetOffset(e,i),3==t&&(this.smallMapLocked_=!1),!0;if(6==t&&(this.drapBackground_=null),3==t&&this.drapSelect_){let t=this.visable_.nodes;for(let e of this.selectPoint_)t[e].pos.x+=this.drapSelect_.dx,t[e].pos.y+=this.drapSelect_.dy;this.drapSelect_=null}if(this.drapBackground_)return 2==t&&(this.offx_-=this.drapBackground_.x-e,this.offy_-=this.drapBackground_.y-i,this.drapBackground_.x=e,this.drapBackground_.y=i),!0;if(this.drapSelect_)return 2==t&&(Math.abs(this.drapSelect_.x-e)>10||Math.abs(this.drapSelect_.y-i)>10||0!=this.drapSelect_.dx||0!=this.drapSelect_.dy)&&(this.drapSelect_.dx-=this.drapSelect_.x-e,this.drapSelect_.dy-=this.drapSelect_.y-i,this.drapSelect_.x=e,this.drapSelect_.y=i),!0;if(this.scrollX_.onTouch(t,e,i))return!0;if(this.scrollY_.onTouch(t,e,i))return!0;if(o.InRect(e,i,...this.smallMapRect))return 1==t&&(this.resetOffset(e,i),this.smallMapLocked_=!0),!0;if(this.searchInput&&o.InRect(e,i,...this.searchInput.pos))return this.searchInput.btnUp.onTouch(t,e,i)&&this.searchInput.btnUp.isClicked()&&(this.searchInput.point-=1,this.searchInput.point<0&&(this.searchInput.point=this.searchInput.result.length-1),this.locateNode(this.searchInput.result[this.searchInput.point])),this.searchInput.btnDown.onTouch(t,e,i)&&this.searchInput.btnDown.isClicked()&&this.findNext(),this.searchInput.btnClose.onTouch(t,e,i)&&this.searchInput.btnClose.isClicked()&&(this.searchInput=null,c.HideEx()),!0;for(let s=this.btnGo_.length-1;s>=0;s--)if(this.btnGo_[s].onTouch(t,e,i))return!0;if(1==t){let t=this.visable_.nodes;for(let s in t){let l=t[s];if(!l.hide&&o.InRect(e,i,l.pos.x+this.offx_-3,l.pos.y+this.offy_-10,l.nameWidth+6,20))return o.KEY_CTRL?this.selectPoint_.push(parseInt(s)):this.selectPoint_.indexOf(parseInt(s))<0&&(this.selectPoint_=[parseInt(s)]),this.drapSelect_={x:e,y:i,dx:0,dy:0},!0}this.selectPoint_=[]}return 4==t&&(this.drapBackground_={x:e,y:i}),!1}onKey(t){if(this.loading())return!0;if(this.searchInput)return!0;switch(t){case"PageUp":return this.selectNode(0),!0;case"PageDown":return this.selectNode(1),!0;case"H":case"h":return this.hideNode(0),!0;case" ":return this.hideNode(1),!0;case"S":case"s":return this.hideNode(2),!0;case"Enter":return this.freshNode(),!0}if("ctrl+f"==t||"ctrl+F"==t){this.searchInput={pos:[s.logicw-300,s.logich/2,200,80],result:[],point:0,btnUp:new l(0,0,0,0,"<"),btnDown:new l(0,0,0,0,">"),btnClose:new l(0,0,0,0,"❌")};let t=this.searchInput.pos[0],e=this.searchInput.pos[1],i=this.searchInput.pos[2];this.searchInput.pos[3],this.searchInput.Open=()=>{c.Reset(t,e+10,i-32-40,32,"",null,(t=>{function e(t){try{return new RegExp(t),!0}catch(t){return!1}}if(this.searchInput.result=[],t.length>0){let i=this.visable_.nodes;this.selectPoint_=[];for(let s in i){let o=i[s];"JS_BYTECODE"==o.ir.op?(o.ir.id==t||o.ir.bytecode.indexOf(t)>=0||e(t)&&o.ir.bytecode.match(t))&&this.searchInput.result.push(s):(o.ir.id==t||o.ir.op.indexOf(t)>=0||e(t)&&o.ir.op.match(t))&&this.searchInput.result.push(s)}this.searchInput.result.length>0&&(this.locateNode(this.searchInput.result[0]),this.searchInput.point=0)}}),this.findNext.bind(this))},c.SetSafeArea(...this.searchInput.pos),this.searchInput.Open()}return!1}}}},108:(t,e,i)=>{const{XTools:s}=i(631),{X2DFast:o}=i(319),{NapiLog:l}=i(324);t.exports={LogParser:class{constructor(t){t=(t=(t=t.replace(/\x1B\[[0-9;]*[A-Za-z]/g,"")).replace(/\t/g,"    ")).replace(/\r/g,""),this.logLines_=t.split("\n"),this.stat_=0,this.lineNum_=0,this.initBlock_={filePoint:null,funcPoint:null,blockType:-1},this.procBlock_={blockStat:-1,blockCollect:-1,oneBlock:-1},this.procNormal_=null,this.output_={}}parsing(){if(this.lineNum_>=this.logLines_.length)return!1;for(let t=0;t<300&&this.lineNum_<this.logLines_.length;t++)this.parseLine(this.logLines_[this.lineNum_]),this.lineNum_++;return s.PROC_TO=20*this.lineNum_/this.logLines_.length,!0}isBlock(t){const e=["Build Basic Block","Computed Dom Trees","Inserted Phis","Bytecode2Gate"];for(let i of e)if(t.indexOf(i)>=0)return this.stat_=this.initBlock_.blockType,this.procBlock_.blockStat=0,this.procBlock_.blockCollect={type:"block:"+i,func:this.initBlock_.funcPoint,file:this.initBlock_.filePoint,irList:[],startLine:t},this.procBlock_.oneBlock=null,!0;return!1}splitLast(t){let e=t.lastIndexOf("@");return[t.substring(0,e),t.substring(e+1)]}isStart(t){if("="!=t[11])return;let e=/=+ *After ([a-zA-Z0-9_ ]+) \[([#a-zA-Z0-9_@/.]+)\] *=+/g.exec(t);if(e){let i=this.splitLast(e[2]);this.procNormal_={type:e[1],func:i[0],file:i[1],irList:[],startLine:t},this.stat_=1,[this.initBlock_.funcPoint,this.initBlock_.filePoint]=[i[0],i[i.length-1]],this.initBlock_.blockType=10}else if(e=/=+ *After ([a-zA-Z0-9_ ]+) \[([a-zA-Z0-9_@/.]+)\] *Caller method \[([#a-zA-Z0-9_@/.]+)\] *=+/g.exec(t),e){let i=this.splitLast(e[2]),s=this.splitLast(e[3]);l.logInfo(i[0],"Caller method("+this.lineNum_+"行)",e[3]),this.procNormal_={type:e[1]+" "+i[0],func:s[0],file:s[1],irList:[],startLine:t},this.stat_=1,[this.initBlock_.funcPoint,this.initBlock_.filePoint]=[s[0],s[s.length-1]],this.initBlock_.blockType=10}else t.search("After")>0&&alert(t)}collectNormal(t){let e=t.search('{"id":');if(e>=0){let i=t.lastIndexOf("}"),l=t.substring(e,i+1),r=JSON.parse(l);{let t=[];for(let e of s.CONFIG.MTypeField){let i=r.MType.indexOf(", "+e);i>=0&&t.push(i)}t.push(r.MType.length),t.sort(((t,e)=>parseInt(t)-parseInt(e))),0==t[0]&&t.shift();let e=0,i=[];for(let s of t){let t=r.MType.substring(e,s);t.startsWith(", ")&&(t=t.substring(2)),t.endsWith(", ")&&(t=t.substring(0,t.length-2)),i.push(t),e=s}i.push("inNum=["+r.in[0].length+","+r.in[1].length+","+r.in[2].length+","+r.in[3].length+","+r.in[4].length+"]"),i.push("outNum="+r.out.length),r.maxDetailWidth=0;for(let t of i){let e=o.gi().getTextWidth(t,14);r.maxDetailWidth<e&&(r.maxDetailWidth=e)}r.detailList=i}this.procNormal_.irList.push(r)}else/=+ End[a-zA-Z:.0-9 ]* =+/g.exec(t)?(this.procNormal_.irList.length>0?(this.procNormal_.file in this.output_||(this.output_[this.procNormal_.file]={}),this.procNormal_.func in this.output_[this.procNormal_.file]||(this.output_[this.procNormal_.file][this.procNormal_.func]=[]),this.output_[this.procNormal_.file][this.procNormal_.func].push(this.procNormal_)):l.logError("After和End之间没有指令("+this.lineNum_+"行)"),this.stat_=0):(l.logError("After和End之间解析失败("+(this.lineNum_+1)+")行"),this.stat_=0)}parseLine(t){switch(this.stat_){case 0:if(this.SearchBegin(t)||this.isBlock(t))return;this.isStart(t);break;case 1:this.collectNormal(t);break;case 10:this.CollectBlock(t)&&(this.stat_=0,this.lineNum_-=1);break;case 20:this.CollectBlock2(t)&&(this.stat_=0,this.lineNum_-=1)}}static Load(t,e){const i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=()=>{i.readyState===XMLHttpRequest.DONE&&200===i.status&&(s.PORC_TO=10,e(t,i.responseText))},i.send()}NumberStringToArray(t){let e=t.split(","),i=[];for(let t of e){let e=parseInt(t);isNaN(e)||i.push(e)}return i}SearchBegin(t){let e,i=this.initBlock_;return t.startsWith("[compiler] aot method")&&(e=/^\[compiler\] aot method \[([#a-zA-Z0-9_@/.]+)\] (recordName \[[a-zA-Z0-9_]*\] )*log:/g.exec(t),e)?([i.funcPoint,i.filePoint]=this.splitLast(e[1]),i.blockType=10,!0):(t.startsWith("[compiler] ==================== Before state split")&&(e=/^\[compiler\] =+ Before state split linearizer \[([#a-zA-Z0-9_@/.]+)\] *=*/g.exec(t),e)||!(!t.startsWith("[compiler] ==================== After graph lineari")||(e=/^\[compiler\] =+ After graph linearizer \[([#a-zA-Z0-9_@/.]+)\] *=*/g.exec(t),!e)))&&([i.funcPoint,i.filePoint]=this.splitLast(e[1]),i.blockType=20,!0)}CollectBlock(t){const e=[/^\[compiler\] B([0-9]+):                               ;preds=([0-9, ]*)$/g,/^\[compiler\]  *Succes:([0-9, ]*)$/g,/^\[compiler\]  *Bytecode\[\] = *(Empty)*$/g,/^\[compiler\]  *Trys:([0-9, ]*)$/g];let i,s=this.procBlock_;if(0==s.blockStat){if(i=e[0].exec(t),i)return s.oneBlock={id:i[1],op:"B"+i[1],detailList:[],maxDetailWidth:0},s.oneBlock.in=[[],[],[],[],this.NumberStringToArray(i[2])],!1;if(!s.oneBlock)return s.blockCollect.file in this.output_||(this.output_[s.blockCollect.file]={}),s.blockCollect.func in this.output_[s.blockCollect.file]||(this.output_[s.blockCollect.file][s.blockCollect.func]=[]),this.output_[s.blockCollect.file][s.blockCollect.func].push(s.blockCollect),!0;if(i=e[1].exec(t),i)return s.oneBlock.out=this.NumberStringToArray(i[1]),!1;if(i=e[2].exec(t),i)return s.blockStat=1,!1}else if(1==s.blockStat)if(/^\[compiler\] *$/g.test(t))0==s.oneBlock.maxDetailWidth&&(s.oneBlock.maxDetailWidth=o.gi().getTextWidth("Empty",14),s.oneBlock.detailList.push("Empty")),s.blockCollect.irList.push(s.oneBlock),s.oneBlock=null,s.blockStat=0;else{let e=t.substring(11);for(;e.startsWith(" ");)e=e.substring(1);let i=o.gi().getTextWidth(e,14);s.oneBlock.maxDetailWidth<i&&(s.oneBlock.maxDetailWidth=i),s.oneBlock.detailList.push(e)}return!1}CollectBlock2(t){const e=[/^\[compiler\] B([0-9]+):/g,/^\[compiler\]  *Preds:([0-9, ]*)$/g,/^\[compiler\]  *Succes:([0-9, ]*)$/g,/^\[compiler\]  *Bytecode\[\] = *(Empty)*$/g,/^\[compiler\]  *Trys:([0-9, ]*)$/g];let i,s=this.procBlock_;switch(s.blockStat){case 0:if(i=e[0].exec(t),i)return s.oneBlock={id:i[1],op:"B"+i[1],detailList:[],maxDetailWidth:0},s.blockStat=1,!1;if(!s.oneBlock)return s.blockCollect.file in this.output_||(this.output_[s.blockCollect.file]={}),s.blockCollect.func in this.output_[s.blockCollect.file]||(this.output_[s.blockCollect.file][s.blockCollect.func]=[]),this.output_[s.blockCollect.file][s.blockCollect.func].push(s.blockCollect),!0;break;case 1:if(i=e[1].exec(t),i)return s.oneBlock.in=[[],[],[],[],this.NumberStringToArray(i[1])],s.blockStat=2,!1;break;case 2:if(i=e[2].exec(t),i)return s.oneBlock.out=this.NumberStringToArray(i[1]),s.blockStat=3,!1;break;case 3:if(/^\[compiler\] *$/g.test(t))0==s.oneBlock.maxDetailWidth&&(s.oneBlock.maxDetailWidth=o.gi().getTextWidth("Empty",14),s.oneBlock.detailList.push("Empty")),s.blockCollect.irList.push(s.oneBlock),s.oneBlock=null,s.blockStat=0;else{let e=t.substring(11);for(;e.startsWith(" ");)e=e.substring(1);let i=o.gi().getTextWidth(e,14);s.oneBlock.maxDetailWidth<i&&(s.oneBlock.maxDetailWidth=i),s.oneBlock.detailList.push(e)}return!1;default:return!1}return!1}}}},324:t=>{class e{constructor(){}}e.LEV_NONE=0,e.LEV_ERROR=1,e.LEV_DEBUG=2,e.LEV_INFO=3;const i=["[NON]","[ERR]","[DBG]","[INF]"];var s=e.LEV_INFO,o=[!0,""],l=null;function r(t,...r){let h=(new Date).toLocaleString(),n=r.join(" ");t==e.LEV_ERROR&&(o=[!1,n],null!=l&&l(n)),s<t||console.log(h,i[t],n)}e.init=function(t,i){s=t in[e.LEV_NONE,e.LEV_ERROR,e.LEV_DEBUG,e.LEV_INFO]?t:e.LEV_ERROR},e.logError=function(...t){r(e.LEV_ERROR,t)},e.logDebug=function(...t){r(e.LEV_DEBUG,t)},e.logInfo=function(...t){r(e.LEV_INFO,t)},e.getResult=function(){return o},e.clearError=function(){o=[!0,""]},e.registError=function(t){l=t},t.exports={NapiLog:e}}},e={};function i(s){var o=e[s];if(void 0!==o)return o.exports;var l=e[s]={exports:{}};return t[s](l,l.exports,i),l.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=i(245),e=i(413),s=i(319);const{NapiLog:o}=i(324),{MainEditor:l}=i(910);let r=document.getElementById("visual_area");r.width=window.innerWidth-0,r.height=window.innerHeight,t.Scr.setLogicScreenSize(r.width,r.height),e.GLFrame.gi().go(r,(function(){r.width==window.innerWidth-0&&r.height==window.innerHeight||(r.width=window.innerWidth-0,r.height=window.innerHeight,t.Scr.setLogicScreenSize(r.width,r.height),e.GLFrame.gi().resize());let i=s.X2DFast.gi();i.swapMode2D(),i.clearBuffer(),l.gi().onDraw(i),i.freshBuffer()}),(function(t,e,i){l.gi().onTouch(t,e,i)}),(function(t,e){l.gi().onKey(e)}))})()})();